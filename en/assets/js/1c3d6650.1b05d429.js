"use strict";(self.webpackChunklukso_docs=self.webpackChunklukso_docs||[]).push([[7346],{3905:(e,a,n)=>{n.d(a,{Zo:()=>c,kt:()=>f});var r=n(7294);function t(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function i(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?i(Object(n),!0).forEach((function(a){t(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function o(e,a){if(null==e)return{};var n,r,t=function(e,a){if(null==e)return{};var n,r,t={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],a.indexOf(n)>=0||(t[n]=e[n]);return t}(e,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}var s=r.createContext({}),p=function(e){var a=r.useContext(s),n=a;return e&&(n="function"==typeof e?e(a):l(l({},a),e)),n},c=function(e){var a=p(e.components);return r.createElement(s.Provider,{value:a},e.children)},d={inlineCode:"code",wrapper:function(e){var a=e.children;return r.createElement(r.Fragment,{},a)}},u=r.forwardRef((function(e,a){var n=e.components,t=e.mdxType,i=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),u=p(n),f=t,m=u["".concat(s,".").concat(f)]||u[f]||d[f]||i;return n?r.createElement(m,l(l({ref:a},c),{},{components:n})):r.createElement(m,l({ref:a},c))}));function f(e,a){var n=arguments,t=a&&a.mdxType;if("string"==typeof e||t){var i=n.length,l=new Array(i);l[0]=u;var o={};for(var s in a)hasOwnProperty.call(a,s)&&(o[s]=a[s]);o.originalType=e,o.mdxType="string"==typeof e?e:t,l[1]=o;for(var p=2;p<i;p++)l[p]=n[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},5740:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>i,metadata:()=>o,toc:()=>p});var r=n(7462),t=(n(7294),n(3905));const i={sidebar_label:"Leer Datos del Perfil",sidebar_position:2},l="Leer Datos de un Perfil Universal",o={unversionedId:"es/guides/universal-profile/read-profile-data",id:"es/guides/universal-profile/read-profile-data",title:"Leer Datos de un Perfil Universal",description:"En esta gu\xeda aprenderemos a leer datos de un Perfil Universal.",source:"@site/docs/es/guides/universal-profile/read-profile-data.md",sourceDirName:"es/guides/universal-profile",slug:"/es/guides/universal-profile/read-profile-data",permalink:"/lukso-es/en/es/guides/universal-profile/read-profile-data",draft:!1,editUrl:"https://github.com/lukso-network/docs/tree/main/docs/es/guides/universal-profile/read-profile-data.md",tags:[],version:"current",lastUpdatedAt:1680495619,formattedLastUpdatedAt:"Apr 3, 2023",sidebarPosition:2,frontMatter:{sidebar_label:"Leer Datos del Perfil",sidebar_position:2},sidebar:"guidesSidebar",previous:{title:"Crear un Perfil Universal",permalink:"/lukso-es/en/es/guides/universal-profile/create-profile"},next:{title:"Editar un Perfil Universal",permalink:"/lukso-es/en/es/guides/universal-profile/edit-profile"}},s={},p=[{value:"Configuraci\xf3n",id:"configuraci\xf3n",level:2},{value:"Step 1 - Call the Universal Profile",id:"step-1---call-the-universal-profile",level:2},{value:"Paso 2 - Obtener Informaci\xf3n Espec\xedfica",id:"paso-2---obtener-informaci\xf3n-espec\xedfica",level:2},{value:"C\xf3digo final",id:"c\xf3digo-final",level:2}],c={toc:p};function d(e){let{components:a,...i}=e;return(0,t.kt)("wrapper",(0,r.Z)({},c,i,{components:a,mdxType:"MDXLayout"}),(0,t.kt)("h1",{id:"leer-datos-de-un-perfil-universal"},"Leer Datos de un Perfil Universal"),(0,t.kt)("p",null,"En esta gu\xeda aprenderemos a leer datos de un ",(0,t.kt)("a",{parentName:"p",href:"/lukso-es/en/es/standards/universal-profile/introduction"},"Perfil Universal"),"."),(0,t.kt)("admonition",{type:"tip"},(0,t.kt)("p",{parentName:"admonition"},"Un archivo JS completo ",(0,t.kt)("em",{parentName:"p"},'"listo para usar"')," est\xe1 disponible al final en la secci\xf3n ",(0,t.kt)("a",{parentName:"p",href:"#final-code"},(0,t.kt)("strong",{parentName:"a"},"C\xf3digo Final")),". Si deseas ejecutar el c\xf3digo como archivos JavaScript independientes dentro del terminal o el navegador, puedes abrir el repositorio ",(0,t.kt)("a",{parentName:"p",href:"https://github.com/lukso-network/lukso-playground"},(0,t.kt)("inlineCode",{parentName:"a"},"lukso-playground"))," o utilizar la p\xe1gina asociada ",(0,t.kt)("a",{parentName:"p",href:"https://stackblitz.com/github/lukso-network/lukso-playground"},"StackBlitz"),".")),(0,t.kt)("div",{style:{textAlign:"center",color:"grey"}},(0,t.kt)("img",{src:n(823).Z,alt:"Universal Profile example on universalprofile.cloud"}),(0,t.kt)("br",null),(0,t.kt)("i",null,"Un ",(0,t.kt)("a",{href:"https://universalprofile.cloud/0x0C03fBa782b07bCf810DEb3b7f0595024A444F4e"},"Perfil Universal")," tal y como se ve en UniversalProfile.cloud")),(0,t.kt)("p",null,"Utilizaremos:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"https://web3js.readthedocs.io/en/v1.7.0/"},"web3.js")," para la utilidad as\xed como la conexi\xf3n a la red LUKSO L16."),(0,t.kt)("li",{parentName:"ul"},"librer\xeda ",(0,t.kt)("a",{parentName:"li",href:"../../tools/erc725js/getting-started/"},"erc725.js")," para comprobar la interfaz de un perfil."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"https://github.com/matthew-andrews/isomorphic-fetch"},"isomorphic-fetch")," para poder utilizar ",(0,t.kt)("inlineCode",{parentName:"li"},"fetch()")," en c\xf3digo Node.js.")),(0,t.kt)("h2",{id:"configuraci\xf3n"},"Configuraci\xf3n"),(0,t.kt)("p",null,"Abre una terminal en el directorio del proyecto que elijas e instala todas las librer\xedas necesarias."),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},"npm install web3 @erc725/erc725.js isomorphic-fetch\n")),(0,t.kt)("h2",{id:"step-1---call-the-universal-profile"},"Step 1 - Call the Universal Profile"),(0,t.kt)("admonition",{title:"Recomendaci\xf3n",type:"success"},(0,t.kt)("p",{parentName:"admonition"},'Los archivos JSON y JS completos "listos para usar" est\xe1n disponibles al final en la secci\xf3n ',(0,t.kt)("a",{parentName:"p",href:"#final-code"},(0,t.kt)("strong",{parentName:"a"},"C\xf3digo final")),".")),(0,t.kt)("p",null,"Para inspeccionar la direcci\xf3n y comprobar si tiene un contrato ERC725, podemos llamar a su interfaz a trav\xe9s de la librer\xeda ",(0,t.kt)("inlineCode",{parentName:"p"},"erc725.js"),". La instancia del contrato necesitar\xe1 la siguiente informaci\xf3n:"),(0,t.kt)("p",null,"-",(0,t.kt)("a",{parentName:"p",href:"../../standards/universal-profile/lsp3-universal-profile-metadata"},"Metadatos del Perfil Universal - LSP3")," que describen los datos en el almacenamiento del contrato del Perfil Universal, y qu\xe9 claves utilizar para recuperarlos. Podemos importar el esquema directamente desde la librer\xeda ",(0,t.kt)("a",{parentName:"p",href:"../../tools/erc725js/schemas#standard-lsp-schemas"},"erc725.js"),"."),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("inlineCode",{parentName:"p"},"SupportedStandards")," muestra la interfaz que utiliza un Est\xe1ndar de Metadatos con una clave. En nuestro caso utilizamos ",(0,t.kt)("inlineCode",{parentName:"p"},"SupportedStandards:LSP3UniversalProfile")," de para comprobar si el contrato es un Perfil Universal.")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("inlineCode",{parentName:"p"},"LSP3Profile")," muestra los datos del Perfil Universal.")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"LSP12IssuedAssets[]` muestra los activos emitidos por el Perfil Universal.")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"LSP5ReceivedAssets[]` muestra los activos recibidos por el Perfil Universal.")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},'LSP1UniversalReceiverDelegate" apuntar\xe1 al ',"[Receptor Universal]"," (../../standards/generic-standards/lsp1-universal-receiver/) del Perfil Universal.")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("inlineCode",{parentName:"p"},"address"),": la direcci\xf3n del contrato.")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("inlineCode",{parentName:"p"},"provider"),": un objeto ",(0,t.kt)("a",{parentName:"p",href:"../../tools/erc725js/providers"},"provider"),". Suele utilizarse con la URL del endpoint RPC")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("inlineCode",{parentName:"p"},"config"),": se utiliza para configurar la pasarela IPFS"))),(0,t.kt)("p",null,"Adem\xe1s del esquema, tambi\xe9n usamos ",(0,t.kt)("inlineCode",{parentName:"p"},"isomorphic-fetch")," para obtener la respuesta HTTP del perfil mientras usamos ",(0,t.kt)("inlineCode",{parentName:"p"},"node")," para la ejecuci\xf3n. Puede que no necesites esta librer\xeda si utilizas entornos de navegador como ",(0,t.kt)("inlineCode",{parentName:"p"},"ReactJS")," o ",(0,t.kt)("inlineCode",{parentName:"p"},"VueJS"),"."),(0,t.kt)("p",null,"Despu\xe9s de importar el objeto ERC725, podemos declarar todos los datos necesarios para instanciar el Perfil Universal como instancia del contrato ERC725."),(0,t.kt)("admonition",{type:"info"},(0,t.kt)("p",{parentName:"admonition"},"Despu\xe9s de inicializar el perfil ERC725, podemos elegir entre llamar a la funci\xf3n ",(0,t.kt)("inlineCode",{parentName:"p"},"getData()")," o ",(0,t.kt)("inlineCode",{parentName:"p"},"fetchData()"),"."),(0,t.kt)("ul",{parentName:"admonition"},(0,t.kt)("li",{parentName:"ul"},"La funci\xf3n ",(0,t.kt)("inlineCode",{parentName:"li"},"getData()")," proporcionar\xe1 la informaci\xf3n b\xe1sica del perfil con claves, nombres y valores, incluyendo su hash y URL."),(0,t.kt)("li",{parentName:"ul"},"La funci\xf3n ",(0,t.kt)("inlineCode",{parentName:"li"},"fetchData()")," tambi\xe9n obtendr\xe1 los datos enlazados desde las URL de almacenamiento y los incluir\xe1 en la respuesta.")),(0,t.kt)("p",{parentName:"admonition"},"Utilizaremos la conveniente funci\xf3n ",(0,t.kt)("inlineCode",{parentName:"p"},"fetchData()")," ya que s\xf3lo necesitamos un comando para devolver la lista completa de informaci\xf3n del perfil sin tener que buscar por separado los archivos de almacenamiento.")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="leer_prerfil.js"',title:'"leer_prerfil.js"'},"// Importaci\xf3n y Configuraci\xf3n de la Red\nimport Web3 from 'web3';\nimport { ERC725 } from '@erc725/erc725.js';\nimport 'isomorphic-fetch';\nimport erc725schema from '@erc725/erc725.js/schemas/LSP3UniversalProfileMetadata.json';\n\n// Nuestras variables est\xe1ticas\nconst SAMPLE_PROFILE_ADDRESS = '0xa907c1904c22DFd37FF56c1f3c3d795682539196';\nconst RPC_ENDPOINT = 'https://rpc.l16.lukso.network';\nconst IPFS_GATEWAY = 'https://2eff.lukso.dev/ipfs/';\n\n// Par\xe1metros de la instancia ERC725\nconst provider = new Web3.providers.HttpProvider(RPC_ENDPOINT);\nconst config = { ipfsGateway: IPFS_GATEWAY };\n\n/*\n * Intenta obtener el @param del Perfil Universal\n *\n * @param direcci\xf3n del Perfil Universal\n * @return cadena JSON o error personalizado\n */\nasync function fetchProfile(address) {\n  try {\n    const profile = new ERC725(erc725schema, address, provider, config);\n    return await profile.fetchData();\n  } catch (error) {\n    return console.log('Este no es un Contrato ERC725');\n  }\n}\n\n// Depurar\nfetchProfile(SAMPLE_PROFILE_ADDRESS).then((profileData) =>\n  console.log(JSON.stringify(profileData, undefined, 2)),\n);\n")),(0,t.kt)("p",null,"Si todo ha ido bien, ahora tenemos los ",(0,t.kt)("a",{parentName:"p",href:"../../standards/universal-profile/lsp3-universal-profile-metadata"},"Metadatos del Perfil Universal - LSP3")," JSON del perfil. Deber\xeda parecerse a este archivo JSON:"),(0,t.kt)("details",null,(0,t.kt)("summary",null,"Mostrar la respuesta JSON"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-json"},'[\n  {\n    "key": "...",\n    "name": "SupportedStandards:LSP3UniversalProfile",\n    "value": null\n  },\n  {\n    "key": "...",\n    "name": "LSP3Profile",\n    "value": {\n      "LSP3Profile": {\n        "name": "...",\n        "links": [\n          {\n            "title": "...",\n            "url": "..."\n          },\n          ...\n        ],\n        "description": "...",\n        "profileImage": [\n          {\n            "width": 1512,\n            "height": 1998,\n            "hashFunction": "keccak256(bytes)",\n            "hash": "0x...",\n            "url": "ipfs://..."\n          },\n          ...\n        ],\n        "backgroundImage": [\n          {\n            "width": 1512,\n            "height": 1998,\n            "hashFunction": "keccak256(bytes)",\n            "hash": "0x...",\n            "url": "ipfs://..."\n          },\n          ...\n        ],\n        "tags": [\n          "...",\n          ...\n        ]\n      }\n    }\n  },\n  {\n    "key": "0x7c8c3416d6cda87cd42c71ea1843df28ac4850354f988d55ee2eaa47b6dc05cd",\n    "name": "LSP12IssuedAssets[]",\n    "value": []\n  },\n  {\n    "key": "0x6460ee3c0aac563ccbf76d6e1d07bada78e3a9514e6382b736ed3f478ab7b90b",\n    "name": "LSP5ReceivedAssets[]",\n    "value": []\n  },\n  {\n    "key": "0x0cfc51aec37c55a4d0b1a65c6255c4bf2fbdf6277f3cc0730c45b828b6db8b47",\n    "name": "LSP1UniversalReceiverDelegate",\n    "value": "0x..."\n  }\n]\n'))),(0,t.kt)("h2",{id:"paso-2---obtener-informaci\xf3n-espec\xedfica"},"Paso 2 - Obtener Informaci\xf3n Espec\xedfica"),(0,t.kt)("p",null,"Con la respuesta JSON, podemos obtener todo tipo de datos, entre ellos:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"SupportedStandards:LSP3UniversalProfile"),": Comprueba si el contrato inteligente es un Perfil Universal LSP3"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"LSP3Profile"),": Los datos del Perfil Universal (nombre, descripci\xf3n, etiquetas, enlaces, im\xe1genes)"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"LSP12IssuedAssets[]"),": Activos emitidos por el Perfil Universal"),(0,t.kt)("li",{parentName:"ul"},"LSP5Activos recibidos[]`: Activos recibidos por el perfil universal"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"LSP1UniversalReceiverDelegate"),": El Receptor Delegado Universal que pertenece al Perfil Universal")),(0,t.kt)("admonition",{type:"info"},(0,t.kt)("p",{parentName:"admonition"},"Para obtener s\xf3lo una parte espec\xedfica de informaci\xf3n del Perfil Universal, puedes definir un nombre espec\xedfico dentro de la funci\xf3n ",(0,t.kt)("inlineCode",{parentName:"p"},"fetchData()")," de la librer\xeda ",(0,t.kt)("a",{parentName:"p",href:"../../tools/erc725js/getting-started/"},"erc725.js"),".")),(0,t.kt)("p",null,"En nuestro caso, para leer s\xf3lo la informaci\xf3n del perfil, podemos utilizar ",(0,t.kt)("inlineCode",{parentName:"p"},"fetchData('LSP3Profile')"),". Si no, puedes buscar en todo el conjunto JSON del paso anterior para extraer el elemento deseado."),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="leer_perfil.js"',title:'"leer_perfil.js"'},"// ...\n\n/*\n * Obtener el @param del Perfil Universal\n * datos LSP3\n *\n * @param direcci\xf3n del Perfil Universal\n * @return cadena JSON o error personalizado\n */\nasync function fetchProfileData(address) {\n  try {\n    const profile = new ERC725(erc725schema, address, provider, config);\n    return await profile.fetchData('LSP3Profile');\n  } catch (error) {\n    return console.log('Este no es un Contrato ERC725');\n  }\n}\n\n// Depurar\nfetchProfileData(SAMPLE_PROFILE_ADDRESS).then((profileData) =>\n  console.log(JSON.stringify(profileData, undefined, 2)),\n);\n")),(0,t.kt)("h2",{id:"c\xf3digo-final"},"C\xf3digo final"),(0,t.kt)("p",null,"A continuaci\xf3n se muestra el fragmento de c\xf3digo completo de esta gu\xeda, con todos los pasos compilados juntos."),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="leer_perfil.js"',title:'"leer_perfil.js"'},"// Importaci\xf3n y Configuraci\xf3n de la Red\nimport Web3 from 'web3';\nimport { ERC725 } from '@erc725/erc725.js';\nimport from 'isomorphic-fetch';\nimport erc725schema from '@erc725/erc725.js/schemas/LSP3UniversalProfileMetadata.json';\n\n// Nuestras variables est\xe1ticas\nconst SAMPLE_PROFILE_ADDRESS = '0x0C03fBa782b07bCf810DEb3b7f0595024A444F4e';\nconst RPC_ENDPOINT = 'https://rpc.l16.lukso.network';\nconst IPFS_GATEWAY = 'https://2eff.lukso.dev/ipfs/';\n\n// Par\xe1metros de la instancia ERC725\nconst provider = new Web3.providers.HttpProvider(RPC_ENDPOINT);\nconst config = { ipfsGateway: IPFS_GATEWAY };\n\n/*\n * Intenta obtener el @param del Perfil Universal\n *\n * @param direcci\xf3n del Perfil Universal\n * @return cadena JSON o error personalizado\n */\nasync function fetchProfile(address) {\n  try {\n    const profile = new ERC725(erc725schema, address, provider, config);\n    return await profile.fetchData();\n  } catch (error) {\n      return console.log('Este no es un Contrato ERC725');\n  }\n}\n\n/*\n * Obtener el @param del Perfil Universal\n * datos LSP3\n *\n * @param direcci\xf3n del Perfil Universal\n * @return cadena JSON o error personalizado\n */\nasync function fetchProfileData(address) {\n  try {\n    const profile = new ERC725(erc725schema, address, provider, config);\n    return await profile.fetchData('LSP3Profile');\n  } catch (error) {\n      return console.log('Este no es un Contrato ERC725');\n  }\n}\n\n// Paso 1\nfetchProfile(SAMPLE_PROFILE_ADDRESS).then((profileData) =>\n  console.log(JSON.stringify(profileData, undefined, 2)),\n);\n\n// Paso 2\nfetchProfileData(SAMPLE_PROFILE_ADDRESS).then((profileData) =>\n  console.log(JSON.stringify(profileData, undefined, 2)),\n);\n\n")))}d.isMDXComponent=!0},823:(e,a,n)=>{n.d(a,{Z:()=>r});const r=n.p+"assets/images/example-up-2016580464323b8f0345c4a8535bb372.png"}}]);