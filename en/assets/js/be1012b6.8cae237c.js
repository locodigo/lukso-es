"use strict";(self.webpackChunklukso_docs=self.webpackChunklukso_docs||[]).push([[3483],{3905:(e,n,a)=>{a.d(n,{Zo:()=>d,kt:()=>m});var t=a(7294);function r(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function s(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function l(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?s(Object(a),!0).forEach((function(n){r(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function o(e,n){if(null==e)return{};var a,t,r=function(e,n){if(null==e)return{};var a,t,r={},s=Object.keys(e);for(t=0;t<s.length;t++)a=s[t],n.indexOf(a)>=0||(r[a]=e[a]);return r}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)a=s[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var i=t.createContext({}),c=function(e){var n=t.useContext(i),a=n;return e&&(a="function"==typeof e?e(n):l(l({},n),e)),a},d=function(e){var n=c(e.components);return t.createElement(i.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},p=t.forwardRef((function(e,n){var a=e.components,r=e.mdxType,s=e.originalType,i=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),p=c(a),m=r,f=p["".concat(i,".").concat(m)]||p[m]||u[m]||s;return a?t.createElement(f,l(l({ref:n},d),{},{components:a})):t.createElement(f,l({ref:n},d))}));function m(e,n){var a=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var s=a.length,l=new Array(s);l[0]=p;var o={};for(var i in n)hasOwnProperty.call(n,i)&&(o[i]=n[i]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var c=2;c<s;c++)l[c]=a[c];return t.createElement.apply(null,l)}return t.createElement.apply(null,a)}p.displayName="MDXCreateElement"},5266:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>i,contentTitle:()=>l,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var t=a(7462),r=(a(7294),a(3905));const s={title:"Nonces multicanales",sidebar_position:1},l="Preguntas m\xe1s frecuentes",o={unversionedId:"es/standards/faq/channel-nonce",id:"es/standards/faq/channel-nonce",title:"Nonces multicanales",description:"\xbfQu\xe9 son los nonces multicanal?",source:"@site/docs/es/standards/faq/channel-nonce.md",sourceDirName:"es/standards/faq",slug:"/es/standards/faq/channel-nonce",permalink:"/lukso-es/en/es/standards/faq/channel-nonce",draft:!1,editUrl:"https://github.com/lukso-network/docs/tree/main/docs/es/standards/faq/channel-nonce.md",tags:[],version:"current",lastUpdatedAt:1681103476,formattedLastUpdatedAt:"Apr 10, 2023",sidebarPosition:1,frontMatter:{title:"Nonces multicanales",sidebar_position:1},sidebar:"standardsSidebar",previous:{title:"\ud83c\udd99 API RPC",permalink:"/lukso-es/en/es/standards/rpc-api"}},i={},c=[{value:"\xbfQu\xe9 son los nonces multicanal?",id:"qu\xe9-son-los-nonces-multicanal",level:2},{value:"Problema de los Nonces Secuenciales.",id:"problema-de-los-nonces-secuenciales",level:3},{value:"Nonces multicanal",id:"nonces-multicanal",level:3},{value:"Nonces en el Gestor de Claves",id:"nonces-en-el-gestor-de-claves",level:3},{value:"Ejemplo de c\xf3digo solidity",id:"ejemplo-de-c\xf3digo-solidity",level:3}],d={toc:c};function u(e){let{components:n,...s}=e;return(0,r.kt)("wrapper",(0,t.Z)({},d,s,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"preguntas-m\xe1s-frecuentes"},"Preguntas m\xe1s frecuentes"),(0,r.kt)("h2",{id:"qu\xe9-son-los-nonces-multicanal"},"\xbfQu\xe9 son los nonces multicanal?"),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Los desarrolladores tomaron este concepto de ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/amxx/permit#out-of-order-execution"},"Ejecuci\xf3n fuera de orden"),".")),(0,r.kt)("p",null,"El uso de nonces evita que las transacciones firmadas antiguas vuelvan a reproducirse (ataques de repetici\xf3n). Un nonce es un n\xfamero arbitrario que los constructores pueden usar s\xf3lo una vez en una transacci\xf3n."),(0,r.kt)("h3",{id:"problema-de-los-nonces-secuenciales"},"Problema de los Nonces Secuenciales."),(0,r.kt)("p",null,"Con transacciones nativas, los nonces son estrictamente secuenciales. La secuencialidad significa que los nonces de los mensajes deben ejecutarse en orden. Por ejemplo, para que el mensaje n\xfamero 4 se ejecute, debe esperar a que el mensaje n\xfamero 3 se complete."),(0,r.kt)("p",null,"Sin embargo, los ",(0,r.kt)("strong",{parentName:"p"},"nonces secuenciales tienen la siguiente limitaci\xf3n"),":"),(0,r.kt)("p",null,"Algunos usuarios pueden querer firmar m\xfaltiples mensajes, permitiendo la transferencia de diferentes activos a diferentes destinatarios. En ese caso, el destinatario querr\xe1 poder utilizar o transferir sus activos cuando quiera y seguramente no querr\xe1 esperar a nadie antes de firmar otra transacci\xf3n."),(0,r.kt)("p",null,"Ante este problema, resulta \xfatil la ",(0,r.kt)("strong",{parentName:"p"},"ejecuci\xf3n fuera de orden"),"."),(0,r.kt)("h3",{id:"nonces-multicanal"},"Nonces multicanal"),(0,r.kt)("p",null,"La ejecuci\xf3n fuera de orden se consigue utilizando varios canales independientes. El nonce de cada canal se comporta como se espera, pero los diferentes canales son independientes. La subdivisi\xf3n significa que los mensajes 2, 3 y 4 del canal 0 deben ejecutarse secuencialmente, pero el mensaje 3 del ",(0,r.kt)("inlineCode",{parentName:"p"},"channel 1")," es independiente y s\xf3lo depende del mensaje 2 del ",(0,r.kt)("inlineCode",{parentName:"p"},"channel 1"),"."),(0,r.kt)("p",null,"La ventaja es que la clave del firmante puede determinar en qu\xe9 canal firmar los nonces. Los servicios de retransmisi\xf3n tendr\xe1n que entender el canal que elige el firmante y ejecutar las transacciones de cada canal en el orden correcto para evitar transacciones fallidas."),(0,r.kt)("h3",{id:"nonces-en-el-gestor-de-claves"},"Nonces en el Gestor de Claves"),(0,r.kt)("p",null,"El Gestor de Claves permite la ejecuci\xf3n fuera de orden de los mensajes mediante el uso de nonces a trav\xe9s de m\xfaltiples canales."),(0,r.kt)("p",null,"Los nonces se representan como ",(0,r.kt)("inlineCode",{parentName:"p"},"uint256")," a partir de la concatenaci\xf3n de dos ",(0,r.kt)("inlineCode",{parentName:"p"},"uint128"),": el ",(0,r.kt)("inlineCode",{parentName:"p"},"channelId")," y el ",(0,r.kt)("inlineCode",{parentName:"p"},"nonceId"),"."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"m\xe1s 128 bits a la izquierda: ",(0,r.kt)("inlineCode",{parentName:"li"},"channelId")),(0,r.kt)("li",{parentName:"ul"},"m\xe1s 128 bits a la derecha: ",(0,r.kt)("inlineCode",{parentName:"li"},"nonceId"))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"multi-channel-nonce",src:a(2834).Z,width:"1062",height:"207"})),(0,r.kt)("p",{align:"center"},(0,r.kt)("i",null,"Ejemplo de nonce multicanal, donde channelId == 5 y nonceId == 1")),(0,r.kt)("p",null,"El nonce actual puede ser consultado usando:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-solidity"},"function getNonce(address _address, uint256 _channel) public view returns (uint256)\n")),(0,r.kt)("p",null,"Como el ",(0,r.kt)("inlineCode",{parentName:"p"},"channelId")," representa los 128 bits m\xe1s a la izquierda, un valor m\xednimo como ",(0,r.kt)("inlineCode",{parentName:"p"},"1")," devolver\xe1 un n\xfamero ",(0,r.kt)("inlineCode",{parentName:"p"},"nonce")," enorme: ",(0,r.kt)("inlineCode",{parentName:"p"},"2**128")," igual a:"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"340282366920938463463374607431768211456"),"."),(0,r.kt)("p",null,"Despu\xe9s de que se ejecute la transacci\xf3n firmada el ",(0,r.kt)("inlineCode",{parentName:"p"},"nonceId")," se incrementar\xe1 en ",(0,r.kt)("inlineCode",{parentName:"p"},"1"),", esto incrementar\xe1 el ",(0,r.kt)("inlineCode",{parentName:"p"},"nonce")," en ",(0,r.kt)("inlineCode",{parentName:"p"},"1")," porque el nonceId representa los primeros 128 bits del nonce, por lo que ser\xe1"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"340282366920938463463374607431768211457"),"."),(0,r.kt)("h3",{id:"ejemplo-de-c\xf3digo-solidity"},"Ejemplo de c\xf3digo solidity"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-solidity"},"_nonces[signer][nonce >> 128]++\n")),(0,r.kt)("p",null,"La expresi\xf3n ",(0,r.kt)("inlineCode",{parentName:"p"},"nonce >> 128")," representa el canal que el firmante eligi\xf3 para ejecutar la transacci\xf3n. Despu\xe9s de buscar el nonce del firmante en ese canal espec\xedfico, se incrementar\xe1 en uno utilizando ",(0,r.kt)("inlineCode",{parentName:"p"},"++"),"."),(0,r.kt)("p",null,"Para mensajes secuenciales, los usuarios pueden usar el canal ",(0,r.kt)("inlineCode",{parentName:"p"},"0"),", y para mensajes fuera de orden, pueden usar el canal ",(0,r.kt)("inlineCode",{parentName:"p"},"n"),"."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Importante:")," Es decisi\xf3n del usuario elegir el canal en el que quiere firmar m\xfaltiples \xf3rdenes secuenciales, no es necesario el ",(0,r.kt)("inlineCode",{parentName:"p"},"canal 0"),"."))}u.isMDXComponent=!0},2834:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/multi-channel-nonce-589f24cc0ff9a9ee7f2c1f9f870a8128.jpg"}}]);